SELECT HISTORY_ID, CAR_ID, DATE_FORMAT(START_DATE,"%Y-%m-%d") AS START_DATE, DATE_FORMAT(END_DATE,"%Y-%m-%d") AS END_DATE, IF(DIFF>=30,"장기 대여","단기 대여") AS RENT_TYPE
FROM (
    SELECT *, DATEDIFF(END_DATE, START_DATE)+1 AS DIFF FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE DATE_FORMAT(START_DATE,"%Y")=2022 AND DATE_FORMAT(START_DATE,"%m")=9
) A
ORDER BY HISTORY_ID DESC;
