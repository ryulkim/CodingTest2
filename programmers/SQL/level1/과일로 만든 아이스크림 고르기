SELECT I.FLAVOR
FROM ICECREAM_INFO I
JOIN (
    SELECT *
    FROM FIRST_HALF 
    WHERE TOTAL_ORDER>3000
) H
ON I.FLAVOR=H.FLAVOR
WHERE INGREDIENT_TYPE="fruit_based"
ORDER BY TOTAL_ORDER DESC;
